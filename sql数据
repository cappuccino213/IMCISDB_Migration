
INSERT INTO PatientIndex(PatientID, PIDAssigningAuthority, IsMPI, PatientMasterID, Password, CreateDate, CreateUserID, CreateUserName, CreateOrgnizationID, Name, NameSpell, MotherName, Sex, BirthDate, BirthPlace, Nation, Citizenship, MaritalStatus, IdentityType, IdentityID, IDCardNO, HealthCardNO, InsuranceType, InsuranceID, ContactPhoneNO, HomePhoneNO, BusinessPhoneNO, Email, AddressProvince, AddressCity, AddressDistrict, AddressStreet, AddressRoad, AddressDetail, Postalcode, Occupation, WorkUnit, Language, LastUpdateDate, InHospitalFlag, Status) VALUES (%%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s);





SELECT ObservationUID,CONVERT(nvarchar,PatientID),CONVERT(nvarchar,PIDAssigningAuthority),CONVERT(nvarchar,Name)PatientMasterID,CONVERT(nvarchar,Name)PatientClass,VisitUID,OrderUID,CONVERT(nvarchar,OrganizationID),CONVERT(nvarchar,PlacerOrderNO),CONVERT(nvarchar,PlacerAssigningAuthority),CONVERT(nvarchar,PlacerOrderDetailNO),CONVERT(nvarchar,FillerOrderNO),CONVERT(nvarchar,FillerAssigningAuthority),CONVERT(nvarchar,FillerPatientID),CONVERT(nvarchar,AccessionNumber),CONVERT(nvarchar,ServiceID),CONVERT(nvarchar,ServiceCodeScheme),CONVERT(nvarchar,ServiceText),CONVERT(nvarchar,ServiceIDInsur),CONVERT(nvarchar,ServiceSectID),CONVERT(nvarchar,ProcedureID),CONVERT(nvarchar,ProcedureName),CONVERT(nvarchar,ProviderID),CONVERT(nvarchar,ProviderName),CONVERT(nvarchar,ProviderPhone),CONVERT(nvarchar,RequestDeptID),CONVERT(nvarchar,RequestDeptName),CONVERT(nvarchar,RequestOrgID),CONVERT(nvarchar,RequestOrgName),RequestedDate,CONVERT(nvarchar,Reason),CONVERT(nvarchar,Attention),CONVERT(nvarchar,Symptom),CONVERT(nvarchar,AdverseReaction),CONVERT(nvarchar,ClinicDiagnosis),CONVERT(nvarchar,RelevantClinicalInfo),FastingFlag,CONVERT(nvarchar,TransportationMode),RegTime,CONVERT(nvarchar,RegisterID),CONVERT(nvarchar,RegisterName),CONVERT(nvarchar,ObservationDeptID),CONVERT(nvarchar,ObservationDeptName),ObservationDate,ObservationEndDate,CONVERT(nvarchar,ObservationLocation),CONVERT(nvarchar,ObservationEquipmentID),CONVERT(nvarchar,CObservationEquipment),CONVERT(nvarchar,EquipmentModel),CONVERT(nvarchar,ObservationMethod),CONVERT(nvarchar,StudyInstanceUID),CONVERT(nvarchar,TechnicianID),CONVERT(nvarchar,TechnicianName),CONVERT(nvarchar,ResultAssistantID),CONVERT(nvarchar,ResultAssistantName),CONVERT(nvarchar,ResultPrincipalID),CONVERT(nvarchar,ResultPrincipalName),CONVERT(nvarchar,ResultReviseID),CONVERT(nvarchar,ResultReviseName),PreliminaryDate,AuditDate,ReviseDate,ResultDate,CONVERT(nvarchar,ResultOrganizationID),ResultServiceCenterUID,CONVERT(nvarchar,ResultStatus),CONVERT(nvarchar,ResultStatusCode),ResultPrintCount,ResultPrintTime,CONVERT(nvarchar,AbnormalFlags),CONVERT(nvarchar,CriticalValue),CONVERT(nvarchar,InfectionName),PrivacyLevel,CONVERT(nvarchar,PrivacyLevelExt),Charges,Payments,PaymentsFlag,FilmCount,FilmNeed,HasImage,ImageLocation,ConsultStatus,ConsultRequestDate,ConsultEndDate,LastUpdateDate,CONVERT(nvarchar,DataSource),LockFlag,LockUserUID,CONVERT(nvarchar,Name)LockReason,InWritingUserUID,MessageCount,UnProcessWorkflowCount,PushState,DeleteFlag CONVERT(nvarchar,GroupID)FROM ObservationRequest




INSERT INTO ExamRequest (ExamUID,PatientID,PIDAssigningAuthority,PatientMasterID,PatientClass,VisitUID,OrderUID,OrganizationID,PlacerOrderNO,PlacerAssigningAuthority,PlacerOrderDetailNO,FillerOrderNO,FillerAssigningAuthority,FillerPatientID,AccessionNumber,ServiceID,ServiceCodeScheme,ServiceText,ServiceIDInsur,ServiceSectID,ProcedureID,ProcedureName,ProviderID,ProviderName,ProviderPhone,RequestDeptID,RequestDeptName,RequestOrgID,RequestOrgName,RequestedDate,Reason,Attention,Symptom,AdverseReaction,ClinicDiagnosis,RelevantClinicalInfo,FastingFlag,TransportationMode,RegTime,RegisterID,RegisterName,ExamDeptID,ExamDeptName,ExamDate,ExamEndDate,ExamLocation,ExamEquipmentID,ExamEquipment,EquipmentModel,ExamMethod,StudyInstanceUID,TechnicianID,TechnicianName,ResultAssistantID,ResultAssistantName,ResultPrincipalID,ResultPrincipalName,ResultReviseID,ResultReviseName,PreliminaryDate,AuditDate,ReviseDate,ResultDate,ResultOrganizationID,ResultServiceCenterUID,ResultStatus,ResultStatusCode,ResultPrintCount,ResultPrintTime,AbnormalFlags,CriticalValue,InfectionName,PrivacyLevel,PrivacyLevelExt,Charges,Payments,PaymentsFlag,FilmCount,FilmNeed,HasImage,ImageLocation,ConsultStatus,ConsultRequestDate,ConsultEndDate,LastUpdateDate,DataSource,LockFlag,LockUserUID,LockReason,InWritingUserUID,MessageCount,UnProcessWorkflowCount,PushState,DeleteFlag,GroupID)VALUES(%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s)



INSERT INTO ExamResult (ResultSeq, ExamUID, ImagingFinding, ImagingDiagnosis, ResultStatus, ResultStatusCode, ReferencesRange, AbnormalFlags, ExamMethod, ExamDate, PreliminaryDate, AuditDate, ResultPrincipalID, ResultPrincipalName, ResultAssistantID, ResultAssistantName, LastUpdateDate, DeleteFlag, RowTimestamp) VALUES (%%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s)




INSERT INTO Visit (VisitUID, PatientID, PIDAssigningAuthority, PatientMasterID, VisitID, AlternateVisitID, AssigningAuthority, PatientClass, PatientType, MedRecNO, OutPatientNO, InPatientNO, CardType, CardNO, Age, AgeUnit, MaritalStatus, PregnancyFlag, Occupation, OrganizationID, AdmitDate, ReAmissionFlag, AdmissionType, AdmitPatCondition, AdmitDeptID, AdmitDeptName, DeptID, DeptName, PointOfCare, PointOfCareID, Room, Bed, AdmittingDoctorID, AdmittingDoctorName, AttendingDoctorID, AttendingDoctorName, DirectorDoctorID, DirectorDoctorName, CurPatCondition, NursingGrade, DietType, PrimaryDiagnosis, DischargeDate, DischargeDisposition, TotalCharges, TotalPayments, PaymentMode, MedicalPaymentMode, LastUpdateDate, DeleteFlag, RowTimestamp, ClinicalPathway) VALUES (%%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s)






INSERT INTO Visit (VisitUID,PatientID,PIDAssigningAuthority,PatientMasterID,VisitID,AlternateVisitID,AssigningAuthority,PatientClass,PatientType,MedRecNO,OutPatientNO,InPatientNO,CardType,CardNO,Age,AgeUnit,MaritalStatus,PregnancyFlag,Occupation,OrganizationID,AdmitDate,ReAmissionFlag,AdmissionType,AdmitPatCondition,AdmitDeptID,AdmitDeptName,DeptID,DeptName,PointOfCare,PointOfCareID,Room,Bed,AdmittingDoctorID,AdmittingDoctorName,AttendingDoctorID,AttendingDoctorName,DirectorDoctorID,DirectorDoctorName,CurPatCondition,NursingGrade,DietType,PrimaryDiagnosis,DischargeDate,DischargeDisposition,TotalCharges,TotalPayments,PaymentMode,MedicalPaymentMode,LastUpdateDate,DeleteFlag,ClinicalPathway) VALUES (%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s);



;获取源数据
[getData]
#用;号来对查询语句进行分隔
get_sql = SELECT ObservationUID,CONVERT(nvarchar,INSPECTIONRESULT),CONVERT(nvarchar,DIAGNOSE),CONVERT(nvarchar,ResultStatus),CONVERT(nvarchar,ResultStatusCode),CONVERT(nvarchar,ReferencesRange),CONVERT(nvarchar,AbnormalFlags),CONVERT(nvarchar,ObservationMethod),ObservationDate,PreliminaryDate,AuditDate,CONVERT(nvarchar,ResultPrincipalID),CONVERT(nvarchar,ResultPrincipalName),CONVERT(nvarchar,ResultAssistantID),CONVERT(nvarchar,ResultAssistantName),LastUpdateDate,DeleteFlag FROM ExamResult;SELECT ObservationUID,CONVERT (nvarchar, PatientID),CONVERT (nvarchar,PIDAssigningAuthority),CONVERT (nvarchar, PatientMasterID),CONVERT (nvarchar, PatientClass),VisitUID,OrderUID,CONVERT (nvarchar, OrganizationID),CONVERT (nvarchar, PlacerOrderNO),CONVERT (nvarchar,PlacerAssigningAuthority),CONVERT (nvarchar,PlacerOrderDetailNO),CONVERT (nvarchar, FillerOrderNO),CONVERT (nvarchar,FillerAssigningAuthority),CONVERT (nvarchar, FillerPatientID),CONVERT (nvarchar, AccessionNumber),CONVERT (nvarchar, ServiceID),CONVERT (nvarchar, ServiceCodeScheme),CONVERT (nvarchar, ServiceText),CONVERT (nvarchar, ServiceIDInsur),CONVERT (nvarchar, ServiceSectID),CONVERT (nvarchar, ProcedureID),CONVERT (nvarchar, ProcedureName),CONVERT (nvarchar, ProviderID),CONVERT (nvarchar, ProviderName),CONVERT (nvarchar, ProviderPhone),CONVERT (nvarchar, RequestDeptID),CONVERT (nvarchar, RequestDeptName),CONVERT (nvarchar, RequestOrgID),CONVERT (nvarchar, RequestOrgName),RequestedDate,CONVERT (nvarchar, Reason),CONVERT (nvarchar, Attention),CONVERT (nvarchar, Symptom),CONVERT (nvarchar, AdverseReaction),CONVERT (nvarchar, ClinicDiagnosis),CONVERT (nvarchar,RelevantClinicalInfo),FastingFlag,CONVERT (nvarchar,TransportationMode),RegTime,CONVERT (nvarchar, RegisterID),CONVERT (nvarchar, RegisterName),CONVERT (nvarchar, ObservationDeptID),CONVERT (nvarchar,ObservationDeptName),ObservationDate,ObservationEndDate,CONVERT (nvarchar,ObservationLocation),CONVERT (nvarchar,ObservationEquipmentID),CONVERT (nvarchar,ObservationEquipment),CONVERT (nvarchar, EquipmentModel),CONVERT (nvarchar, ObservationMethod),CONVERT (nvarchar, StudyInstanceUID),CONVERT (nvarchar, TechnicianID),CONVERT (nvarchar, TechnicianName),CONVERT (nvarchar, ResultAssistantID),CONVERT (nvarchar,ResultAssistantName),CONVERT (nvarchar, ResultPrincipalID),CONVERT (nvarchar,ResultPrincipalName),CONVERT (nvarchar, ResultReviseID),CONVERT (nvarchar, ResultReviseName),PreliminaryDate,AuditDate,ReviseDate,ResultDate,CONVERT (nvarchar,ResultOrganizationID),ResultServiceCenterUID,CONVERT (nvarchar, ResultStatus),CONVERT (nvarchar, ResultStatusCode),ResultPrintCount,ResultPrintTime,CONVERT (nvarchar, AbnormalFlags),CONVERT (nvarchar, CriticalValue),CONVERT (nvarchar, InfectionName),PrivacyLevel,CONVERT (nvarchar, PrivacyLevelExt),Charges,Payments,PaymentsFlag,FilmCount,FilmNeed,HasImage,ImageLocation,ConsultStatus,ConsultRequestDate,ConsultEndDate,LastUpdateDate,CONVERT (nvarchar, DataSource),LockFlag,LockUserUID,CONVERT (nvarchar, LockReason) ,InWritingUserUID,MessageCount,UnProcessWorkflowCount,PushState,DeleteFlag,  CONVERT (nvarchar, GroupID) FROM ObservationRequest;select PatientID, PIDAssigningAuthority, IsMPI, PatientMasterID, Password, CreateDate, CreateUserID, CreateUserName, CreateOrgnizationID, CONVERT(nvarchar,Name), NameSpell, MotherName, CONVERT(nvarchar,Sex), BirthDate, BirthPlace, Nation, Citizenship, CONVERT(nvarchar,MaritalStatus), IdentityType, IdentityID, IDCardNO, HealthCardNO, InsuranceType, InsuranceID, ContactPhoneNO, HomePhoneNO, BusinessPhoneNO, Email, AddressProvince, AddressCity, AddressDistrict, AddressStreet, AddressRoad, CONVERT(nvarchar,AddressDetail), Postalcode, Occupation, WorkUnit, Language, LastUpdateDate, InHospitalFlag, Status from PatientIndex;select FileUID,BusinessID,BusinessType,BusinessTime,ClassCode,TypeCode,FormatCode,EntryUUID,UniqueID,MimeType,FileSHA,FileSize,FileCreateTime,FileCreateUserID,FileCreateUserName,CreateOrganizationID,OriginalFileName,Title,UploadTime,ParentFileUID,TransformMimeType,DicomInfo,DeleteFlag,FolderFlag from Document;select * from DocumentInservice


;插入目标数据
[MigrationData]
#插入sql语句需要与查询相匹配，同样用;分隔
insert_sql =INSERT INTO ExamResult(ExamUID,ImagingFinding,ImagingDiagnosis,ResultStatus,ResultStatusCode,ReferencesRange,AbnormalFlags,ExamMethod,ExamDate,PreliminaryDate,AuditDate,ResultPrincipalID,ResultPrincipalName,ResultAssistantID,ResultAssistantName,LastUpdateDate,DeleteFlag) VALUES (%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s);INSERT INTO ExamRequest (ExamUID,PatientID,PIDAssigningAuthority,PatientMasterID,PatientClass,VisitUID,OrderUID,OrganizationID,PlacerOrderNO,PlacerAssigningAuthority,PlacerOrderDetailNO,FillerOrderNO,FillerAssigningAuthority,FillerPatientID,AccessionNumber,ServiceID,ServiceCodeScheme,ServiceText,ServiceIDInsur,ServiceSectID,ProcedureID,ProcedureName,ProviderID,ProviderName,ProviderPhone,RequestDeptID,RequestDeptName,RequestOrgID,RequestOrgName,RequestedDate,Reason,Attention,Symptom,AdverseReaction,ClinicDiagnosis,RelevantClinicalInfo,FastingFlag,TransportationMode,RegTime,RegisterID,RegisterName,ExamDeptID,ExamDeptName,ExamDate,ExamEndDate,ExamLocation,ExamEquipmentID,ExamEquipment,EquipmentModel,ExamMethod,StudyInstanceUID,TechnicianID,TechnicianName,ResultAssistantID,ResultAssistantName,ResultPrincipalID,ResultPrincipalName,ResultReviseID,ResultReviseName,PreliminaryDate,AuditDate,ReviseDate,ResultDate,ResultOrganizationID,ResultServiceCenterUID,ResultStatus,ResultStatusCode,ResultPrintCount,ResultPrintTime,AbnormalFlags,CriticalValue,InfectionName,PrivacyLevel,PrivacyLevelExt,Charges,Payments,PaymentsFlag,FilmCount,FilmNeed,HasImage,ImageLocation,ConsultStatus,ConsultRequestDate,ConsultEndDate,LastUpdateDate,DataSource,LockFlag,LockUserUID,LockReason,InWritingUserUID,MessageCount,UnProcessWorkflowCount,PushState,DeleteFlag,GroupID)VALUES(%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s);INSERT INTO PatientIndex(PatientID, PIDAssigningAuthority, IsMPI, PatientMasterID, Password, CreateDate, CreateUserID, CreateUserName, CreateOrgnizationID, Name, NameSpell, MotherName, Sex, BirthDate, BirthPlace, Nation, Citizenship, MaritalStatus, IdentityType, IdentityID, IDCardNO, HealthCardNO, InsuranceType, InsuranceID, ContactPhoneNO, HomePhoneNO, BusinessPhoneNO, Email, AddressProvince, AddressCity, AddressDistrict, AddressStreet, AddressRoad, AddressDetail, Postalcode, Occupation, WorkUnit, Language, LastUpdateDate, InHospitalFlag, Status) VALUES (%%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s);INSERT INTO Document(FileUID,BusinessID,BusinessType,BusinessTime,ClassCode,TypeCode,FormatCode,EntryUUID,UniqueID,MimeType,FileSHA,FileSize,FileCreateTime,FileCreateUserID,FileCreateUserName,CreateOrganizationID,OriginalFileName,Title,UploadTime,ParentFileUID,TransformMimeType,DicomInfo,DeleteFlag,FolderFlag)VALUES(%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s,%%s);INSERT INTO DocumentInService (FileUID, ServiceUID, MediaUID, FileRelativePath, CreateTime, DeleteFlag, MigrationFlag, FileDeleteFlag) VALUES (%%s, %%s, %%s, %%s, %%s, %%s, %%s, %%s)
